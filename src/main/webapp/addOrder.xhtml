<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:pt="jakarta.faces.passthrough">
    <h:head>
        <meta charset="utf-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <title>Ela Admin - HTML5 Admin Template</title>
        <meta name="description" content="Ela Admin - HTML5 Admin Template"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>

        <link rel="apple-touch-icon" href="https://i.imgur.com/QRAUqs9.png"/>
        <link rel="shortcut icon" href="https://i.imgur.com/QRAUqs9.png"/>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.0/normalize.min.css"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lykmapipo/themify-icons@0.1.2/css/themify-icons.css"/>
        <link rel="stylesheet"
              href="https://cdn.jsdelivr.net/npm/pixeden-stroke-7-icon@1.2.3/pe-icon-7-stroke/dist/pe-icon-7-stroke.min.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.0/css/flag-icon.min.css"/>
        <link rel="stylesheet" href="assets/css/cs-skin-elastic.css"/>
        <link rel="stylesheet" href="assets/css/style.css"/>

        <link rel="stylesheet" href="assets/css/addOrder.css"/>

        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'/>

        <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.min.js"></script> -->

        <style>


            .payment {
                padding: 20px 0 0 0;
            }
            .payment__title {
                margin: 40px 0 20px 0;
                font-size: 18px;
                display: flex;
                text-align: left;
            }
            .payment__title .icon {
                margin-right: 10px;
            }


            .payment__types {
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .payment__info {
                display: flex;
            }

            .payment__cc {
                flex: 60%;
            }

            .payment__shipping {
                flex: 40%;
            }

            .payment__type {
                display: flex;
                border: 2px solid #d9d9d9;
                border-radius: 8px;
                padding: 20px 40px;
                width: 100%;
                justify-content: center;
                align-items: center;
                cursor: pointer;
                color: #d9d9d9;
                transition: all 0.15s ease;
            }
            .payment__type:hover {
                -webkit-transform: translateY(-1px);
                transform: translateY(-1px);
            }
            .payment__type.active {
                color: #0a0a0a;
                background: #f6fcf7;
                border-color: #7dc855;
            }
            .payment__type .icon {
                font-size: 32px;
                margin-right: 10px;
            }
            .payment_type + .payment_type {
                margin-left: 10px;
            }


        </style>

    </h:head>

    <body>


        <div id="right-panel" class="right-panel">


            <div class="content">
                <div class="animated fadeIn">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-body card-block">
                                    <h:form id="orderForm" enctype="multipart/form-data" class="form-horizontal">
                                        <div class="row form-group">
                                            <div class="col col-md-3">
                                                <label for="product-category" class="form-control-label">User Id</label>
                                            </div>
                                            <div class="col-12 col-md-9">
                                                <h:inputText id="product-category" value="#{productCDIBean.userId}" 
                                                             class="form-control" disabled="true"/>
                                            </div>
                                        </div>

                                        <div class="row form-group">
                                            <div class="col col-md-3">
                                                <label for="car-category" class="form-control-label">Address</label>
                                            </div>
                                            <div class="col-12 col-md-9">
                                                <h:inputText id="car-category" value="#{productCDIBean.shippingAddress}" 
                                                             class="form-control"/>
                                            </div>
                                        </div>

                                        <div class="row form-group">
                                            <div class="col col-md-3">
                                                <label for="car-description" class="form-control-label">Shipping Price</label>
                                            </div>
                                            <div class="col-12 col-md-9">
                                                <h:inputText id="car-description" value="#{productCDIBean.shippingPrice}"  
                                                             class="form-control" disabled="true"/>
                                            </div>
                                        </div>

                                        <div class="row form-group">
                                            <div class="col col-md-3">
                                                <label for="car-price" class="form-control-label">Total Price</label>
                                            </div>
                                            <div class="col-12 col-md-9">

                                                <h:inputText id="car-price" value="#{productCDIBean.totalPrice+productCDIBean.shippingPrice}" class="form-control" required="true" disabled="true">
                                                    <f:convertNumber integerOnly="true" />
                                                </h:inputText>
                                            </div>
                                        </div>

                                        <div class="row form-group">
                                            <div class="col col-md-3">
                                                <label for="car-model" class="form-control-label">Delivery At</label>
                                            </div>
                                            <div class="col-12 col-md-9">
                                                <h:inputText id="car-productDate" value="#{productCDIBean.deliverAt}" 
                                                             class="form-control"/>
                                            </div>
                                        </div>



                                        <div class="row form-group">
                                            <div class="col col-md-12 text-right">
                                                <!--<h:commandButton value="Pay" type="button" onclick="openRazorpayPayment();" />-->
                                                
                                                <h:commandButton value="Pay" type="button" 
                                                                 
                                                                 onclick="openRazorpayPayment(); return false;" />

                                                <!-- Hidden Command Button to Process Payment -->
                                                <h:commandButton id="hiddenPayButton" value="hiddenPay" 
                                                                 action="#{productCDIBean.addorder()}" 
                                                                 style="display:none;" />
                                            </div>
                                        </div>
                                    </h:form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>





        <!-- Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/jquery@2.2.4/dist/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery-match-height@0.7.2/dist/jquery.matchHeight.min.js"></script>
        <script src="assets/js/main.js"></script>
        <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
        <script type="text/javascript">
                                         function openRazorpayPayment() {
                                             // Access total amount using the JSF EL expression
                                             var totalAmount = #{productCDIBean.totalPrice+productCDIBean.shippingPrice};

                                             var options = {
                                                 "key": "rzp_test_VWZZ4Jn0Rd1lpQ", // Your Razorpay key
                                                 "amount": totalAmount * 100, // Amount in paise
                                                 "currency": "INR",
                                                 "name": "Your Company",
                                                 "description": "Order Payment",
                                                 "image": "path/to/logo.png",
                                                 "handler": function (response) {
                                                     // Trigger the hidden button to process payment in JSF
                                                                             document.getElementById('orderForm:hiddenPayButton').click();

                                                     // In this version, we won't send the paymentId and signature explicitly to the backend
                                                     // as we are not verifying them on the server-side.
                                                     // However, you can still handle success logic here if needed.
                                                 },
                                                 "prefill": {
                                                     "name": "#{loginBean.u.name}",
                                                     "email": "#{loginBean.u.email}",
                                                     "contact": "#{loginBean.u.contact}"
                                                 },
                                                 "theme": {
                                                     "color": "#F37254"
                                                 }
                                             };

                                             var rzp1 = new Razorpay(options);
                                             rzp1.open();
                                         }
        </script>
    </body>

</html>